# Security Policy

## Supported Versions

現在、以下のバージョンのセキュリティアップデートを提供しています：

| Version | Supported          |
| ------- | ------------------ |
| 0.4.x   | :white_check_mark: |
| 0.3.x   | :white_check_mark: |
| 0.2.7   | :x: 　　　　　　　　　|
| < 0.2.7 | :x:                |

## Reporting a Vulnerability

Google Calendar MCPのセキュリティを重視しています。セキュリティ脆弱性を発見された場合は、以下の手順に従ってください：

1. **脆弱性を公開しないでください**
2. **直接メールでご連絡ください**: [ganndamu0706@gmail.com](mailto:ganndamu0706@gmail.com)
3. 以下の情報を含めてください：
   - 脆弱性の詳細な説明
   - 再現手順
   - 潜在的な影響
   - 緩和策の提案（ある場合）

## What to Expect

- 脆弱性報告を受領してから48時間以内に確認の返信をします
- 7日以内に詳細な回答を提供し、次のステップを示します
- 問題の理解と対応について協力して作業します
- 進捗状況をお知らせします

## Security Mechanisms

Google Calendar MCPはOAuthトークンやカレンダーデータなど、センシティブな情報を扱います。以下のセキュリティ対策を実装しています：

### 0.4.x バージョンで追加されたセキュリティ機能

1. **強化されたトークン管理**:
   - AES-256-GCM暗号化によるトークンの保護
   - 適切なトークン有効期限管理
   - メモリ内ストレージのみ（永続的なファイルストレージなし）

2. **強化されたOAuth認証フロー**:
   - CSRF攻撃防止のためのstateパラメータ実装
   - PKCE (Proof Key for Code Exchange) の実装による認証の強化
   - 認証リクエストの厳格な検証

3. **セキュリティヘッダーとミドルウェア**:
   - Helmet.jsによるセキュアなHTTPヘッダー設定
   - Content Security Policy (CSP) の実装
   - レートリミッティングによるブルートフォース攻撃の防止
   - XSS保護

4. **入力検証**:
   - Zodによる厳格なスキーマ検証
   - 日付、時間、メールアドレスなどの厳密な形式チェック
   - 最大長の制限とサニタイズ処理

### 既存のセキュリティ機能

- ローカルのみのサーバー運用
- OAuth認証情報の安全な取り扱い
- 定期的なセキュリティアップデート

## Best Practices for Users

Google Calendar MCPを安全に使用するためのベストプラクティス：

1. 環境変数は安全に保管し、公開リポジトリにさらさないでください
2. 常に最新バージョンのパッケージを使用してください
3. Google Cloud Consoleで不審なアクティビティを定期的に確認してください
4. OAuth認証スコープは必要最小限に制限してください
5. プロジェクトに応じて適切なレートリミットを設定してください

## セキュリティ対策の詳細

### 1. トークン暗号化

リフレッシュトークンはAES-256-GCM暗号化を使用して保護されています：
- 各トークンに一意の初期化ベクター(IV)を使用
- 認証タグによる完全性の検証
- 環境変数またはランダムに生成された暗号化キーの使用

### 2. OAuth 2.0認証フロー

OAuth 2.0のベストプラクティスを実装：
- CSRF攻撃からの保護に一意のstateパラメータを使用
- PKCE拡張を使用してコード傍受攻撃から保護
- 認証コードの交換時に厳格な検証
- 有効期限のある認証セッション

### 3. レート制限と保護

サービス拒否攻撃からの保護：
- APIエンドポイントへのレート制限
- OAuth認証エンドポイントへの特別なレート制限
- 一時的なブロックと段階的バックオフ

## Security Updates

セキュリティアップデートは以下のチャネルで告知されます：
- GitHubリポジトリのリリース
- npmパッケージのアップデート
- リリースノートのドキュメント

Google Calendar MCPとそのユーザーの安全を守るためのご協力に感謝いたします！
